
#include "FLAME.h"
#include "FQAM.h"
#include "__kernels.h"
#include "assertf.h"
  int main (void)    
{ 
FLA_Init();
  
// Turn on parameter checking
FLA_Check_error_level_set(FLA_FULL_ERROR_CHECKING);
FLA_Obj A, B, C_ref, C, ZERO;
int m, n, p, q, r, c;

// Square matrices dimension
m = 256;
n = 1;
p = 2;
q = 1;
r = 512;
c = 1;

// Create FLA objects
FLA_Obj_create_without_buffer(FLA_DOUBLE, m, n, &A);
FLA_Obj_create_without_buffer(FLA_DOUBLE, p, q, &B);
FLA_Obj_create_without_buffer(FLA_DOUBLE, r, c, &C_ref);
FLA_Obj_create(FLA_DOUBLE, r, c, 1, c, &C);
FLA_Obj_create_constant (0.0, &ZERO);
FLA_Set(ZERO, C); // Initialize C to all zeros

// Create buffer for operands and reference
double A_arr[256][1] = {{0.8593722073937407},
 {0.6631353049305844},
 {0.1438886352245602},
 {0.313079158085249},
 {0.6987844738279009},
 {0.958540355533341},
 {0.8368359793358795},
 {0.3892744308266194},
 {0.5404332254083712},
 {0.864756551914643},
 {0.8393114263566747},
 {0.3524073480251717},
 {0.6970126390915613},
 {0.501787929989631},
 {0.9620719618999136},
 {0.942262053880425},
 {0.4803792240217474},
 {0.06555551057242182},
 {0.07483656056449017},
 {0.37428824635891933},
 {0.5588908079739905},
 {0.8001843340227957},
 {0.2799234767534342},
 {0.38813434694064275},
 {0.23633680933882595},
 {0.9188042642309033},
 {0.8781088188885482},
 {0.5078252326129102},
 {0.10980354121657088},
 {0.2603609394151922},
 {0.9692288828869025},
 {0.04555692794318211},
 {0.598772824467344},
 {0.6981926693753119},
 {0.6547342048782752},
 {0.545248045462624},
 {0.8282188644344752},
 {0.77229026342004},
 {0.30241172579762854},
 {0.29030652646481614},
 {0.09149740486350022},
 {0.7236434025979841},
 {0.6257948282739775},
 {0.4938459033678231},
 {0.054316651205322475},
 {0.5779243310667529},
 {0.312621146702579},
 {0.4428555131147649},
 {0.32054511110683614},
 {0.28696839746557623},
 {0.23124837132448828},
 {0.6863354846559747},
 {0.7616948165157582},
 {0.7490805047515798},
 {0.8603598573033205},
 {0.6582837478970213},
 {0.3197091515228102},
 {0.2986085459070609},
 {0.28529361575638434},
 {0.28178712420168606},
 {0.5258283808593837},
 {0.9008428902477728},
 {0.5089188903233439},
 {0.27481097015180334},
 {0.9441705682527443},
 {0.16395363422447862},
 {0.45660082451003214},
 {0.011926431676889115},
 {0.11194835103072809},
 {0.8698510549414806},
 {0.20600689430557495},
 {0.6143704022013485},
 {0.7154753204355055},
 {0.3846435660947115},
 {0.4621651111968206},
 {0.4303213954164905},
 {0.38128168977030086},
 {0.9770623494722426},
 {0.5803793156906657},
 {0.1606860447527203},
 {0.6569506786363778},
 {0.059433560603831426},
 {0.5141474530047336},
 {0.07108172607310803},
 {0.16853088804734262},
 {0.735581292386805},
 {0.5540101980672697},
 {0.3600131464334486},
 {0.5756717599946347},
 {0.2521483680505274},
 {0.4284815097142316},
 {0.35176591532182655},
 {0.8173304651312266},
 {0.568718067659809},
 {0.6891134992834378},
 {0.7019194729439874},
 {0.529914638103531},
 {0.14037599878650897},
 {0.8455476518140738},
 {0.5986640831227141},
 {0.7379144974825167},
 {0.981383213589353},
 {0.5226301423626254},
 {0.1743085657530251},
 {0.42065084073410774},
 {0.5822975111414396},
 {0.33903915558819153},
 {0.003866662153427347},
 {0.4702200321177463},
 {0.31183221964408003},
 {0.6843406986670905},
 {0.4471844714369867},
 {0.8956179617729985},
 {0.8456168475437671},
 {0.7393382601971827},
 {0.6980106320555027},
 {0.7400742248555232},
 {0.04417123182291094},
 {0.7647154703269046},
 {0.8298879291681316},
 {0.5005514156162736},
 {0.0796750977575329},
 {0.6153849766644764},
 {0.4531847370170454},
 {0.9174935156917123},
 {0.7676562089107976},
 {0.14914777639824883},
 {0.48915292316680603},
 {0.7335869347228936},
 {0.97289702016547},
 {0.29614637757912343},
 {0.48603402704068965},
 {0.9894242319720169},
 {0.12346563706998759},
 {0.6015645296908302},
 {0.06695861464834696},
 {0.3009457737030442},
 {0.9396936931719991},
 {0.727928005837416},
 {0.765371314693499},
 {0.4456542034839196},
 {0.6248078506282648},
 {0.05174373757959283},
 {0.12300505792809269},
 {0.40855627894625113},
 {0.2802030306789083},
 {0.7470277518267933},
 {0.27780214074837595},
 {0.04186021413801144},
 {0.05644169151127976},
 {0.5913470101533741},
 {0.88187366322006},
 {0.027655199452261803},
 {0.4036663489901048},
 {0.9298198170138788},
 {0.1481828360606855},
 {0.17135997983919937},
 {0.09020311348970966},
 {0.5787145423482188},
 {0.3887212005581615},
 {0.5901817353317503},
 {0.0772518601971689},
 {0.474876695659616},
 {0.21255823971598387},
 {0.16378048350382024},
 {0.12384401806627954},
 {0.07101678138147405},
 {0.3606312757740914},
 {0.5685999397148315},
 {0.5097839446177462},
 {0.7038380380202744},
 {0.8238944761544789},
 {0.5792962837954985},
 {0.49572916499641984},
 {0.5319741028727507},
 {0.3336185853456266},
 {0.10016151094189119},
 {0.8689750591064587},
 {0.615296861997678},
 {0.5518987649094511},
 {0.20662490898753216},
 {0.41539592690964566},
 {0.3606928888850157},
 {0.10517806970727728},
 {0.9708428481791287},
 {0.44541159585722223},
 {0.7200266834790996},
 {0.05455403962048111},
 {0.36545662744157414},
 {0.21103674255771876},
 {0.8158432121148412},
 {0.6007214184332902},
 {0.7016735587592898},
 {0.2348042875236268},
 {0.38252740880645997},
 {0.1424329087570575},
 {0.7361728663465927},
 {0.46468179890657246},
 {0.6288709850299106},
 {0.5031959193013135},
 {0.9867025583308905},
 {0.5541061241248635},
 {0.1945627126809747},
 {0.253053193701946},
 {0.038592326832665336},
 {0.9501022670712891},
 {0.3301201784022624},
 {0.431658582892431},
 {0.804631622792092},
 {0.5575965735765297},
 {0.2914748980476064},
 {0.7285017240794954},
 {0.9163122389513104},
 {0.2955689507941228},
 {0.28116011558637477},
 {0.4684730706899922},
 {0.5469726416783114},
 {0.16950682741109113},
 {0.322574825575507},
 {0.7968089429060896},
 {0.08601007259796989},
 {0.9507928040729231},
 {0.18098129683868536},
 {0.7842865227662081},
 {0.8340044740160645},
 {0.557502291210737},
 {0.6776783195387488},
 {0.715555131340843},
 {0.2771595174078231},
 {0.5677640014195632},
 {0.4061629952395479},
 {0.6558901300302478},
 {0.3687296915362196},
 {0.4169967312863535},
 {0.7148572057099374},
 {0.3457428363113264},
 {0.999773799691706},
 {0.27417274060080876},
 {0.413037872424471},
 {0.5193821471321795},
 {0.8310781633266501},
 {0.07857664016747856},
 {0.010846747470904639},
 {0.8645043096588455},
 {0.842226279415576},
 {0.5375150980893186},
 {0.05270937307804535},
 {0.990338271489942},
 {0.9950671263415967},
 {0.36497588144015713},
 {0.447617565947648},
 {0.9312712502166545},
 {0.019768392093023057},
 {0.03708867767379398},
 {0.3602542989610953},
 {0.21331187197534174}};
double B_arr[2][1] = {{0.9740110461668691},
 {0.28534560708003676}};
double C_arr_ref[512][1] = {{0.8370380227703089},
 {0.24521808422647817},
 {0.6459011121056242},
 {0.18922274616162288},
 {0.1401491201265969},
 {0.04105798997007009},
 {0.30494255829965594},
 {0.08933576242794217},
 {0.6806237963982789},
 {0.19939507990252645},
 {0.9336288944861921},
 {0.2735152796603755},
 {0.8150874877030164},
 {0.23878747055001362},
 {0.37915759561544804},
 {0.11107774878495748},
 {0.526387931263343},
 {0.15421024679037404},
 {0.8422824338100358},
 {0.2467544832825231},
 {0.8174986004454717},
 {0.2394938284829569},
 {0.3432486497268894},
 {0.10055788866170841},
 {0.678898009793102},
 {0.19888949464404013},
 {0.4887469866431081},
 {0.14318298150832623},
 {0.937068718097947},
 {0.2745230080230128},
 {0.9177736488634155},
 {0.2688703377929922},
 {0.46789467054625095},
 {0.13707410130712247},
 {0.06385179143464782},
 {0.01870597696172947},
 {0.07289163664694934},
 {0.021354283806056387},
 {0.36456088640401385},
 {0.10680150688020819},
 {0.5443658205677933},
 {0.15947703689279055},
 {0.7793883803078826},
 {0.22832908456766954},
 {0.2726485584392797},
 {0.07987493441016325},
 {0.37804714131694994},
 {0.11075243085639132},
 {0.23019466291184973},
 {0.06743767033614619},
 {0.8949255026261226},
 {0.26217676056469363},
 {0.8552876893339886},
 {0.25056449400808684},
 {0.49462738608723433},
 {0.14490569929049174},
 {0.10694986205317912},
 {0.03133195812798025},
 {0.2535944309807802},
 {0.07429285031735669},
 {0.9440396381958177},
 {0.276565203986869},
 {0.04437295104608748},
 {0.01299946926064879},
 {0.5832113451757288},
 {0.17085719510066258},
 {0.6800473723242865},
 {0.19922621110172975},
 {0.6377183478547219},
 {0.18682552916705658},
 {0.531077619181491},
 {0.15558413454173592},
 {0.8066943226029595},
 {0.236328614667194},
 {0.7522192474182401},
 {0.22036963405759283},
 {0.29455236141727653},
 {0.08629185748584593},
 {0.2827617635510654},
 {0.08283769203339972},
 {0.08911948303265142},
 {0.026108382537023377},
 {0.7048366676162153},
 {0.20648846602378523},
 {0.6095310753729529},
 {0.17856780518138546},
 {0.4810113649845159},
 {0.14091675910048065},
 {0.05290501826477707},
 {0.015499017812737352},
 {0.5629046823076159},
 {0.16490816909456676},
 {0.3044964501536652},
 {0.08920507089190464},
 {0.43134616162967776},
 {0.12636687523847376},
 {0.31221447901284477},
 {0.091466139325318},
 {0.2795103890322758},
 {0.08188517158760013},
 {0.22523846807814943},
 {0.06598570690185587},
 {0.6684983434312111},
 {0.19584281552973035},
 {0.741899165094395},
 {0.21734626982840624},
 {0.7296126860962926},
 {0.2137468313801599},
 {0.8380000046919854},
 {0.24549990578950978},
 {0.6411756419638251},
 {0.1878383756745974},
 {0.31140024514385445},
 {0.09122760193031974},
 {0.2908480221933039},
 {0.08520663681113731},
 {0.27787913314760465},
 {0.08140727998406423},
 {0.2744637716400377},
 {0.08040671802266783},
 {0.5121626513450791},
 {0.1500428185562336},
 {0.8774309259622192},
 {0.25705156140148566},
 {0.4956926207779223},
 {0.14521776971381323},
 {0.2676689205356902},
 {0.07841610311022018},
 {0.9196325629438227},
 {0.2694149239851826},
 {0.1596926507938446},
 {0.04678344929076214},
 {0.4447342467616714},
 {0.13028903946306045},
 {0.011616476194644454},
 {0.0034031548871405054},
 {0.10903893050409535},
 {0.031943970186472166},
 {0.8472445360329063},
 {0.2482081773414872},
 {0.20065299064016068},
 {0.05878316231829725},
 {0.5984035581820956},
 {0.17530789538815014},
 {0.6968808653639627},
 {0.20415773966045317},
 {0.3746470822132652},
 {0.1097563518767257},
 {0.4501539234586426},
 {0.13187678422566945},
 {0.41913779253760286},
 {0.12279031981464703},
 {0.37137257753744235},
 {0.10879705523600874},
 {0.951669521179718},
 {0.2788004492652041},
 {0.5652958644494769},
 {0.1656086881724493},
 {0.15650998255401344},
 {0.04585105698925493},
 {0.6398772177786529},
 {0.18745799021713935},
 {0.057888944541159865},
 {0.016959105431428433},
 {0.5007852985851717},
 {0.14670971710629038},
 {0.06923438637581476},
 {0.02028285827862789},
 {0.16415094657842366},
 {0.04808954856160669},
 {0.7164643041384495},
 {0.2098948904328309},
 {0.5396120526066157},
 {0.15808437629603647},
 {0.3506567813914695},
 {0.10272816982584657},
 {0.5607106532010969},
 {0.16426540783450225},
 {0.24559529575416297},
 {0.07194942915561829},
 {0.41734572353991817},
 {0.12226531651197808},
 {0.34262388718845854},
 {0.1003748586575714},
 {0.7960889014065198},
 {0.23322165775787868},
 {0.5539376800553308},
 {0.16228120227377363},
 {0.6712041603647733},
 {0.19663550980008104},
 {0.6836773201670705},
 {0.2002896381285015},
 {0.5161427110383581},
 {0.15120881411025003},
 {0.13672777343476675},
 {0.0400556745932029},
 {0.8235727529273655},
 {0.24127330802198643},
 {0.5831054299048842},
 {0.17082616623566446},
 {0.7187368716746455},
 {0.210560660257309},
 {0.9558780905587696},
 {0.2800333888598113},
 {0.5090475317209605},
 {0.14913021525078937},
 {0.16977846848495048},
 {0.049738183514047456},
 {0.40971856545440133},
 {0.12003086951800183},
 {0.5671642080072377},
 {0.16615603681784855},
 {0.33022788262598635},
 {0.09674333367521555},
 {0.003766171649233609},
 {0.0011033350595431287},
 {0.4579995054116249},
 {0.1341752205258327},
 {0.30372802648406727},
 {0.08897995402145538},
 {0.6665553998432989},
 {0.19527361211073743},
 {0.4355626148539178},
 {0.12760212447895233},
 {0.8723417879123572},
 {0.2555606510139014},
 {0.8236401503324344},
 {0.24129305271948312},
 {0.7201236322858509},
 {0.2109669246934633},
 {0.6798700659639777},
 {0.19917426755219758},
 {0.7208404699926628},
 {0.2111769289756869},
 {0.04302326771831278},
 {0.01260406695998156},
 {0.7448413152730976},
 {0.21820820012392642},
 {0.8083200100903084},
 {0.23680487495687505},
 {0.48754260798471394},
 {0.1428301475637974},
 {0.07760442532026218},
 {0.0227349391387845},
 {0.599391764916341},
 {0.17559739975425928},
 {0.44140693980882983},
 {0.12931427390353564},
 {0.8936488190702034},
 {0.2618027442270489},
 {0.7477056271376985},
 {0.21904732696041104},
 {0.1452715817231206},
 {0.04255866280099589},
 {0.47644035042928284},
 {0.13957763781600685},
 {0.7145217777437923},
 {0.20932580923448738},
 {0.947612444423999},
 {0.2776118908454748},
 {0.28844984304437066},
 {0.08450406789486876},
 {0.47340251115059845},
 {0.1386876745074806},
 {0.9637101312859151},
 {0.28232785813175426},
 {0.12025689432819758},
 {0.0352303771632591},
 {0.585930496901046},
 {0.17165379592244673},
 {0.06521843030352066},
 {0.019106346546070806},
 {0.2931245078839999},
 {0.0858735544954665},
 {0.9152720371628678},
 {0.26813746734744587},
 {0.7090099184998644},
 {0.20771105873623802},
 {0.7454801149307269},
 {0.21839534243286232},
 {0.43407211696403525},
 {0.12716546924088926},
 {0.6085697482437091},
 {0.17828617544589515},
 {0.05039897197248315},
 {0.014764848212239027},
 {0.11980828515635789},
 {0.035098952928406695},
 {0.39793832867448126},
 {0.11657973944227887},
 {0.27292084705069075},
 {0.07995470389473924},
 {0.7276132820724991},
 {0.21316108735065137},
 {0.27058235373772144},
 {0.07926962049997915},
 {0.04077231096533369},
 {0.011944628215711213},
 {0.05497483099632929},
 {0.01610538872891028},
 {0.575978520007138},
 {0.1687382716071792},
 {0.8589546892999798},
 {0.2516387757994239},
 {0.026936469750450942},
 {0.007891289676625144},
 {0.39317548288221243},
 {0.11518441941036343},
 {0.9056547727163748},
 {0.2653200001608739},
 {0.14433171917544194},
 {0.04228332131457786},
 {0.16690651323431216},
 {0.0488968174764392},
 {0.08785882893762093},
 {0.025739062179230658},
 {0.5636743568245695},
 {0.16513365241239814},
 {0.37861874322289624},
 {0.11091988695814932},
 {0.5748435294590564},
 {0.16840576555578787},
 {0.07524416516898119},
 {0.022043478946023286},
 {0.46253514713968846},
 {0.135503979011155},
 {0.20703407343715358},
 {0.060652559951621395},
 {0.1595240000792716},
 {0.046734041493259534},
 {0.12062544159824556},
 {0.035338346518353575},
 {0.06917112952877337},
 {0.020264326596166962},
 {0.3512588461972154},
 {0.10290455031780625},
 {0.5538226221320617},
 {0.1622474949836009},
 {0.49653519321620426},
 {0.14546460915660664},
 {0.6855460237441641},
 {0.2008370922449172},
 {0.8024823206503285},
 {0.23509466946818863},
 {0.564240979420233},
 {0.16529964977883577},
 {0.48284568261359134},
 {0.14145413953318312},
 {0.5181486524727695},
 {0.15179647333508298},
 {0.3249481873332047},
 {0.09519659776863088},
 {0.09755841805816573},
 {0.028580647145767683},
 {0.8463913064131987},
 {0.24795821577814328},
 {0.59930594025755},
 {0.17557225662116901},
 {0.5375554933876574},
 {0.15748188811980982},
 {0.2012549437670803},
 {0.05895951009290471},
 {0.4046002213427202},
 {0.11853140294260742},
 {0.3513188580478444},
 {0.10292213134834705},
 {0.10244460170939702},
 {0.030012100152129458},
 {0.945611658218576},
 {0.27702574189298546},
 {0.4338358144557477},
 {0.12709624222036706},
 {0.7013139432435389},
 {0.20545645111116914},
 {0.05313623720337363},
 {0.01556675555417456},
 {0.35595879202298336},
 {0.10428144321873879},
 {0.20555211839829188},
 {0.06021840742132569},
 {0.7946403005401154},
 {0.23279727664303657},
 {0.5851092972230545},
 {0.17141321782882799},
 {0.6834377970347659},
 {0.2002194675961794},
 {0.22870196973535406},
 {0.06700037196842479},
 {0.37258592163908166},
 {0.10915251569063272},
 {0.13873122646705177},
 {0.04064260481745806},
 {0.7170405037099075},
 {0.21006369346351927},
 {0.4526052050876933},
 {0.13259491000803947},
 {0.6125272860329727},
 {0.17944557299838054},
 {0.49011838378557177},
 {0.14358474507323046},
 {0.9610591910953968},
 {0.2815512405143533},
 {0.5397054856463273},
 {0.15811174837517536},
 {0.18950623132346012},
 {0.05551761536509149},
 {0.2464766059334998},
 {0.07220761718042391},
 {0.037589352632298095},
 {0.011012150928698082},
 {0.9254101031156203},
 {0.2711075081855762},
 {0.32154070032638105},
 {0.0941983427155636},
 {0.4204402279099649},
 {0.12317188038674909},
 {0.7837200886946711},
 {0.22959809888140462},
 {0.5431052219683372},
 {0.15910773279294324},
 {0.2838997703787306},
 {0.08317108173198606},
 {0.7095687264050371},
 {0.20787476671631705},
 {0.892498242476472},
 {0.26146567209842936},
 {0.2878874229774274},
 {0.08433930169835849},
 {0.2738530583226827},
 {0.08022780386868741},
 {0.4562979456837649},
 {0.1336767327566848},
 {0.532757394945748},
 {0.15607624049586918},
 {0.1651015222991038},
 {0.048368028571828814},
 {0.3141914433258949},
 {0.09204530943258},
 {0.7761007120750774},
 {0.2273659315403405},
 {0.08377476079203701},
 {0.024542596380465753},
 {0.9260826937829988},
 {0.27130454988551866},
 {0.1762777822704846},
 {0.05164221801656701},
 {0.7639037365340904},
 {0.22379271396341474},
 {0.8123295702442364},
 {0.23797951294558065},
 {0.5430133899025965},
 {0.1590808297340392},
 {0.6600661689785425},
 {0.1933725314937634},
 {0.6969586020673659},
 {0.2041805133516883},
 {0.2699564315054983},
 {0.0790862507527453},
 {0.5530084089985564},
 {0.1620089636632561},
 {0.3956072439075411},
 {0.11589682645007487},
 {0.6388442317212855},
 {0.1871553673312853},
 {0.35914679260598015},
 {0.10521539767983727},
 {0.40615942248838593},
 {0.1189881854392955},
 {0.6962788147934609},
 {0.2039813633388408},
 {0.3367573417002956},
 {0.09865619952082921},
 {0.9737907245679444},
 {0.2852810618157449},
 {0.26704727790303134},
 {0.07823398711153522},
 {0.4023034502266968},
 {0.11785854245400745},
 {0.5058839484886088},
 {0.1482034140799647},
 {0.8094793113082305},
 {0.2371445030454049},
 {0.07653451549380343},
 {0.022421499090898772},
 {0.010564851851643669},
 {0.0030950717419291375},
 {0.842036747066579},
 {0.24668250706291137},
 {0.820337699522795},
 {0.24032556899859822},
 {0.5235456430204645},
 {0.15337757197898214},
 {0.05133951161454676},
 {0.015040388059762997},
 {0.9646004158730073},
 {0.2825886752928918},
 {0.9692063727342386},
 {0.28393803325133055},
 {0.3554905401072026},
 {0.10414426445911315},
 {0.43598445369133615},
 {0.12772570609502001},
 {0.9070684846886518},
 {0.26573416024925606},
 {0.01925463226356225},
 {0.005640823842779863},
 {0.036124781741997875},
 {0.010583091246624548},
 {0.35089166661720844},
 {0.1027969816402468},
 {0.20776811958251584},
 {0.06086760560618297}};

FLA_Obj_attach_buffer(A_arr, 1, m, &A);
FLA_Obj_attach_buffer(B_arr, 1, p, &B);
FLA_Obj_attach_buffer(C_arr_ref, 1, r, &C_ref);

// Execute kernel being tested
kernel_kron_prod_rec(A, B, C, 2);

// Check success
bool success = FLA_Obj_equals(C, C_ref);
if (success)
  printf ("Passed test 3 \n");
else
  printf ("Failed test 3 \n");
}
